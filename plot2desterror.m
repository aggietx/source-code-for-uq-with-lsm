% plot2desterror
clear;close all;
reg=4;
if reg==2 %%% p=0.5
    rmstime=[3.14,1.52, 1.05 , 0.85 ,0.79,0.76,0.75,0.74 ;
        1.84,0.87,0.52,0.41,0.37,0.38 ,0.37,0.38;
        1.66,0.65, 0.35,0.32,0.33, 0.32 , 0.38, 0.32;
        1.71,0.53,0.36,0.33,0.33,0.33,0.33,0.33;
        1.28,0.42,0.29,0.26,0.26,0.26,0.26,0.26];
rms=[2.70,1.45 , 0.84,0.57,0.52,0.52,0.52 ,0.52 ;
    1.87,0.88,0.42,0.28,0.26,0.26,0.26,0.26 ;
    1.47, 0.59,0.26,0.19,0.19 ,0.19 ,0.22,0.19;
    1.26,0.46,0.22,0.16,0.16,0.16,0.16,0.16;
    1.28,0.47,0.23,0.16,0.16,0.16,0.16,0.16];
cc=[ 0.21,0.37, 0.67,0.86,0.90,0.90,0.91,0.91;
    0.35,0.67,0.91, 0.96, 0.97, 0.97, 0.97, 0.97;
    0.43,0.83,0.97,0.98,0.98,0.98,0.98,0.98;
    0.55,0.89,0.98,0.99,0.99,0.99,0.99,0.99;
    0.57,0.89,0.97,0.99,0.99,0.99,0.99,0.99];
elseif reg==1
 rmstime=[2.99,1.2,0.76,0.63,0.6,0.60,0.60,0.60;
     2.02,0.68 ,0.41 ,0.32,0.29 ,0.28,0.27,0.26;
     1.63 ,0.57,0.31,0.25,0.25,0.25,0.24,0.23;
     1.33,0.46 ,0.25,0.19 ,0.17 ,0.17 ,0.17,0.17;
     1.01,0.40,0.20,0.17,0.17,0.17,0.17,0.17];
 rms=[2.63,1.39,0.84,0.63,0.61,0.61,0.61,0.61;
     3.09,1.39,0.70 ,0.46,0.42,0.41,0.40,0.39;
      2.75,1.22,0.57,0.37 ,0.35,0.35,0.34,0.33;
      2.22,0.99,0.46,0.3,.27,.27,.27,.27;
      1.48,0.65,0.29,0.21,0.20,0.20,0.20,0.20];
 cc=[0.17,0.33,0.81,0.83,0.84,0.84,0.84,0.84;
     0.26,0.45,0.77,0.91,.93,.93,0.94, 0.94;
     0.32,0.56,0.85,0.94, 0.95, 0.95, 0.95, 0.95;
     0.42,0.69,0.91,0.97,0.98,0.98,0.98,0.98;
     0.51,0.82,0.96,0.98,0.98,0.98,0.98,0.98];
elseif reg==3
     rmstime=[6.3846    5.3399    5.1198    5.5672    6.0070    6.2396    6.3678    6.4636;
         6.3237    5.1646    4.8008    4.9938    5.3187    5.5539    5.6636    5.6714;
         5.3044    3.5715    2.9301    2.5806    2.3725    2.2135    2.0984    2.0351;
         4.4253    1.9198    0.9460    0.8380    0.8383    0.8411       0.8411 0.8411];
      rms=[1.2029    0.8876    0.7283    0.7324    0.7897    0.8247    0.8450    0.8607;
          1.0536    0.7132    0.5762    0.5647    0.5945    0.6197    0.6317    0.6315;
           0.7873    0.4905    0.3737    0.3173    0.2897    0.2710    0.2582    0.2515;
           0.6565    0.2936    0.1374    0.1136    0.1124    0.1127     0.1127   0.1127];
      cc=[ 0.1906    0.4976    0.6305    0.6392    0.6284    0.6217    0.6176    0.6143;
          0.3475    0.6850    0.7808    0.7900    0.7788    0.7692    0.7647    0.7650;
          0.5905    0.8494    0.9045    0.9262    0.9372    0.9450    0.9501    0.9528;
          0.7184    0.9528    0.9895    0.9922    0.9921    0.9921     0.9921     0.9921];
else
rmstime=[ 3.4433    1.7636    1.2715    1.1392    1.0940    1.0605    1.0201    0.9758;
    2.1678    1.1189    0.7662    0.6330    0.5930    0.5695    0.5519    0.5409;
    1.2139    0.6350    0.4634    0.3826    0.3545    0.3420    0.3323    0.3255;
    1.2715    0.5566    0.3273    0.3062    0.3038    0.3046    0.3057    0.3066];
rms=[1.2098    0.6987    0.5413    0.4979    0.4821    0.4682    0.4482    0.4243;
    0.6280    0.3560    0.2474    0.2052    0.1923    0.1834    0.1766    0.1724 ;
    0.3040    0.1675    0.1231    0.1019    0.0944    0.0908    0.0878    0.0858;
     0.4424    0.1883    0.1054    0.1001    0.0999    0.1002    0.1006    0.1009];
 cc=[0.5302    0.7778    0.8492    0.8670    0.8745    0.8821    0.8939    0.9080;
     0.7993    0.9251    0.9618    0.9732    0.9765    0.9787    0.9804    0.9815;
     0.9520    0.9837    0.9907    0.9937    0.9947    0.9952    0.9955    0.9958;
     0.8795    0.9804    0.9938    0.9941    0.9940    0.9940    0.9939    0.9939];
end
% return
length=size(cc,2);range=0:length-1;range2=1:length;
subplot(3,1,1)
plot(range,rmstime(1,range2),'-*r','linewidth',1.5);hold on;
plot(range,rmstime(2,range2),'-*b','linewidth',1.5);hold on;
plot(range,rmstime(3,range2),'-*green','linewidth',1.5);hold on;
plot(range,rmstime(4,range2),'-*k','linewidth',1.5);hold on;
if reg==1 || reg==2
plot(range,rmstime(5,range2),'-*c','linewidth',1.5);hold on;
end
% plot(range,rms(6,range2),'-*y','linewidth',1.5);hold on;
setgca(16)
% lgnd=legend('Exact','Estimation');
% set(lgnd,'FontSize',14);
title('Mean RMS of velocity over time','FontSize',14);
xlim([min(range),max(range)])



subplot(3,1,2)
plot(range,rms(1,range2),'-*r','linewidth',1.5);hold on;
plot(range,rms(2,range2),'-*b','linewidth',1.5);hold on;
plot(range,rms(3,range2),'-*green','linewidth',1.5);hold on;
plot(range,rms(4,range2),'-*k','linewidth',1.5);hold on;
if reg==1 || reg==2
plot(range,rms(5,range2),'-*c','linewidth',1.5);hold on;
end
% plot(range,rms(6,range2),'-*y','linewidth',1.5);hold on;
setgca(16)
% lgnd=legend('Exact','Estimation');
% set(lgnd,'FontSize',14);
title('Mean RMS of velocity over fixed point','FontSize',14);
xlim([min(range),max(range)])

subplot(3,1,3)
plot(range,cc(1,range2),'-*r','linewidth',1.5);hold on;
plot(range,cc(2,range2),'-*b','linewidth',1.5);hold on;
plot(range,cc(3,range2),'-*green','linewidth',1.5);hold on;
plot(range,cc(4,range2),'-*k','linewidth',1.5);hold on;
if reg==1 || reg==2
plot(range,cc(5,range2),'-*c','linewidth',1.5);hold on;
end
% plot(range,cc(6,range2),'-*y','linewidth',1.5);hold on;
setgca(16)
if reg==1 || reg==2
lgnd=legend('L=12','L=24','L=36','L=48','L=60');
else
 lgnd=legend('L=2','L=6','L=12','L=24');   
end
set(lgnd,'FontSize',12);
title('Mean CC of velocity over fixed point','FontSize',14);
xlim([min(range),max(range)])
xlabel('Iteration','FontSize',16);